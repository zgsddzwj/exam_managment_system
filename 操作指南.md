# 代码评估系统操作指南

## 🚀 服务器状态

- **后端服务器**: http://localhost:8000
- **前端服务器**: http://localhost:5173
- **Django Admin**: http://localhost:8000/admin

## 📝 快速开始

### 1. 访问系统

打开浏览器访问：**http://localhost:5173**

### 2. 注册账号

#### 方式一：通过网页注册
1. 点击"注册"按钮
2. 填写信息：
   - 用户名：自定义
   - 邮箱：有效邮箱地址
   - 角色：选择"教师"、"学生"或"管理员"
   - 密码：至少8位
3. 点击"注册"

#### 方式二：通过Django Admin创建（推荐用于创建管理员）
1. 访问 http://localhost:8000/admin
2. 使用以下命令创建超级用户：
   ```bash
   cd backend
   source ../venv/bin/activate
   python manage.py createsuperuser
   ```
3. 登录后可以管理所有用户

## 👨‍🏫 教师操作流程

### 第一步：登录/注册
- 注册时选择"教师"角色
- 登录后进入仪表板

### 第二步：创建班级
1. 点击导航栏"班级管理"
2. 点击"创建班级"按钮
3. 填写班级信息：
   - 班级名称：例如"Python编程基础班"
   - 描述：可选
4. 点击"创建"

### 第三步：生成邀请码
1. 在班级列表中，找到刚创建的班级
2. 点击"生成邀请码"按钮
3. 系统会生成一个8位邀请码（例如：A1B2C3D4）
4. **将邀请码分享给学生**

### 第四步：创建任务
1. 点击导航栏"任务管理"（需要先实现此页面）
2. 或者直接访问：http://localhost:5173/tasks
3. 点击"创建任务"
4. 填写任务信息：
   - 任务标题：例如"计算两数之和"
   - 任务描述：详细说明题目要求
   - 编程语言：选择Java或Python
   - 所属班级：选择已创建的班级
   - 截止时间：可选
5. 添加测试用例：
   - 输入数据：例如"5\n10"
   - 期望输出：例如"15"
   - 是否隐藏：勾选后学生看不到此测试用例
   - 权重：测试用例的权重（默认1.0）
6. 可以添加多个测试用例
7. 点击"创建"

### 第五步：查看学生提交
1. 在任务列表中点击任务
2. 查看学生提交记录
3. 可以查看每个学生的代码、得分、测试结果

### 第六步：导出成绩
1. 在班级或任务页面
2. 点击"导出成绩"按钮
3. 选择格式（Excel或CSV）
4. 下载成绩单

## 👨‍🎓 学生操作流程

### 第一步：注册/登录
- 注册时选择"学生"角色
- 登录后进入仪表板

### 第二步：加入班级
1. 点击导航栏"我的班级"
2. 在"通过邀请码加入班级"区域
3. 输入教师提供的邀请码
4. 点击"加入"
5. 成功后会显示在"我的班级"列表中

### 第三步：查看任务
1. 点击导航栏"我的任务"
2. 查看已加入班级的所有任务
3. 点击任务标题进入代码编辑器

### 第四步：编写和测试代码
1. 在代码编辑器中：
   - 左侧：代码编辑区（Monaco Editor）
   - 右侧：任务描述
2. 编写代码（支持Java或Python）
3. 点击"测试"按钮：
   - 系统会运行所有非隐藏的测试用例
   - 显示测试结果（通过/失败）
   - 显示输出和错误信息
   - **注意：测试不会保存提交记录**
4. 根据测试结果修改代码
5. 可以多次测试

### 第五步：提交代码
1. 测试通过后，点击"提交"按钮
2. 确认提交（提交后无法修改）
3. 系统会：
   - 运行所有测试用例（包括隐藏的）
   - 自动评分
   - 记录测试次数和耗时
   - 保存提交记录

### 第六步：查看提交历史
1. 在任务页面或提交历史页面
2. 查看所有提交记录
3. 点击提交查看详情：
   - 代码内容
   - 得分
   - 每个测试用例的结果
   - 错误信息

## 👨‍💼 管理员操作流程

### 第一步：登录
- 使用管理员账号登录

### 第二步：系统管理
1. 访问管理员页面
2. 查看系统统计：
   - 总用户数
   - 班级数
   - 任务数
   - 提交数
3. 管理用户：
   - 查看所有用户
   - 修改用户角色
   - 删除用户（通过Django Admin）

## 🔧 常见问题

### 1. 代码执行失败
- **原因**：Judge0 API未配置
- **解决**：
  1. 注册RapidAPI账号：https://rapidapi.com/
  2. 订阅Judge0 API
  3. 获取API密钥
  4. 在backend/.env文件中配置：
     ```
     JUDGE0_API_KEY=your-api-key
     ```

### 2. 无法连接数据库
- **原因**：PostgreSQL未安装或未运行
- **解决**：
  - 当前使用SQLite（开发环境），无需配置
  - 如需使用PostgreSQL，设置环境变量：
    ```
    USE_POSTGRES=True
    DB_NAME=exam_management
    DB_USER=postgres
    DB_PASSWORD=your-password
    ```

### 3. 前端无法连接后端
- **检查**：
  1. 后端是否运行在 http://localhost:8000
  2. 前端.env文件是否配置：
     ```
     VITE_API_BASE_URL=http://localhost:8000/api
     ```

### 4. 登录后跳转失败
- **检查**：浏览器控制台是否有错误
- **解决**：清除浏览器缓存和localStorage

## 📊 测试数据示例

### Java任务示例
**任务描述**：
```
编写一个Java程序，计算两个整数的和。

输入格式：两个整数，用空格分隔
输出格式：一个整数，表示两数之和

示例：
输入：5 10
输出：15
```

**测试用例**：
1. 输入：`5 10`，期望输出：`15`
2. 输入：`-3 7`，期望输出：`4`
3. 输入：`0 0`，期望输出：`0`（隐藏测试）

**Java代码模板**：
```java
import java.util.Scanner;

public class Solution {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        int a = scanner.nextInt();
        int b = scanner.nextInt();
        System.out.println(a + b);
    }
}
```

### Python任务示例
**任务描述**：
```
编写一个Python程序，计算斐波那契数列的第n项。

输入格式：一个整数n
输出格式：第n项的值

示例：
输入：5
输出：5
```

**Python代码模板**：
```python
def fibonacci(n):
    if n <= 1:
        return n
    a, b = 0, 1
    for _ in range(2, n + 1):
        a, b = b, a + b
    return b

n = int(input())
print(fibonacci(n))
```

## 🛠️ 开发命令

### 后端
```bash
# 激活虚拟环境
cd backend
source ../venv/bin/activate

# 运行服务器
python manage.py runserver

# 创建迁移
python manage.py makemigrations

# 应用迁移
python manage.py migrate

# 创建超级用户
python manage.py createsuperuser
```

### 前端
```bash
# 进入前端目录
cd frontend

# 安装依赖（首次运行）
npm install

# 运行开发服务器
npm run dev

# 构建生产版本
npm run build
```

## 📝 注意事项

1. **代码执行功能**需要配置Judge0 API密钥才能使用
2. **测试功能**可以多次使用，不会保存提交
3. **提交功能**只能提交一次（每个任务每个学生只能提交一次）
4. **邀请码**可以设置过期时间和使用次数限制
5. **隐藏测试用例**学生看不到，但会在提交时运行

## 🎯 功能清单

- ✅ 用户注册/登录（三种角色）
- ✅ 班级创建和管理
- ✅ 邀请码生成和使用
- ✅ 任务创建和管理
- ✅ 代码在线编辑（Monaco Editor）
- ✅ 代码测试（不保存）
- ✅ 代码提交（自动评分）
- ✅ 提交历史查看
- ✅ 成绩导出（Excel/CSV）
- ✅ 测试次数和耗时统计
- ✅ 管理员系统统计

祝您使用愉快！🎉

